<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.6 -->
    <script>
        window.materialVersion = "1.5.6"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0',
            '1.5.2',
            '1.5.5'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">



    <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>





    <link rel="dns-prefetch" href="https://hm.baidu.com"/>



    <link rel="dns-prefetch" href="https://fonts.googleapis.com"/>





    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            [Flutter] 05-Dart中异步 | 
        
        codeTao
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.jpg">
    <link rel="icon" href="/img/favicon.jpg">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content=",Flutter">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?NKhlKQkXw/c66TR5p4wO+w==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/atelier-dune-light.min.css?ZfnESUNClnkZBE6Ec0djTA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="codeTao">
    <meta name="msapplication-starturl" content="http://yoursite.com/2020/06/19/Flutter-05-Dart中异步/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="codeTao">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.jpg">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://yoursite.com/2020/06/19/Flutter-05-Dart中异步/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="[Flutter] 05-Dart中异步 | codeTao">
    <meta property="og:image" content="/img/favicon.jpg">
    <meta property="og:description" content="">
    <meta property="og:article:tag" content="Flutter"> 

    
        <meta property="article:published_time" content="Fri Jun 19 2020 00:54:26 GMT+0800">
        <meta property="article:modified_time" content="Wed Jun 24 2020 02:08:25 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://yoursite.com/2020/06/19/Flutter-05-Dart中异步/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://yoursite.com/2020/06/19/Flutter-05-Dart中异步/index.html",
    "headline": "[Flutter] 05-Dart中异步",
    "datePublished": "Fri Jun 19 2020 00:54:26 GMT+0800",
    "dateModified": "Wed Jun 24 2020 02:08:25 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "codeTao",
        "image": {
            "@type": "ImageObject",
            "url": "/img/avatar2.png"
        },
        "description": "路上有多长 修行有多远 花叶融一钵 香积云外天"
    },
    "publisher": {
        "@type": "Organization",
        "name": "codeTao",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.jpg"
        }
    },
    "keywords": ",Flutter",
    "description": "",
}
</script>


    

    <!-- Analytics -->
    
    
        <script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?cc539da139de156c41df0dc0f7670373';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(hm, s);
    })();
</script>
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span id="MD-burger-id" class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#一-Dart的异步模型"><span class="post-toc-number">1.</span> <span class="post-toc-text">一. Dart的异步模型</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-1-Dart是单线程的"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">1.1. Dart是单线程的</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-1-1-程序中的耗时操作"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">1.1.1. 程序中的耗时操作</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-1-2-单线程的异步操作"><span class="post-toc-number">1.1.2.</span> <span class="post-toc-text">1.1.2. 单线程的异步操作</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-2-Dart事件循环"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">1.2. Dart事件循环</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-2-1-什么是事件循环"><span class="post-toc-number">1.2.1.</span> <span class="post-toc-text">1.2.1. 什么是事件循环</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-2-2-事件循环代码模拟"><span class="post-toc-number">1.2.2.</span> <span class="post-toc-text">1.2.2. 事件循环代码模拟</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#二-Dart的异步操作"><span class="post-toc-number">2.</span> <span class="post-toc-text">二. Dart的异步操作</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-1-认识Future"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">2.1. 认识Future</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-1-1-同步的网络请求"><span class="post-toc-number">2.1.1.</span> <span class="post-toc-text">2.1.1. 同步的网络请求</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-1-2-异步的网络请求"><span class="post-toc-number">2.1.2.</span> <span class="post-toc-text">2.1.2. 异步的网络请求</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-1-3-Future使用补充"><span class="post-toc-number">2.1.3.</span> <span class="post-toc-text">2.1.3. Future使用补充</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-2-await、async"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">2.2. await、async</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-2-1-理论概念理解"><span class="post-toc-number">2.2.1.</span> <span class="post-toc-text">2.2.1. 理论概念理解</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-2-2-案例代码演练"><span class="post-toc-number">2.2.2.</span> <span class="post-toc-text">2.2.2. 案例代码演练</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-3-读取json案例"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">2.3. 读取json案例</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#三-Dart的异步补充"><span class="post-toc-number">3.</span> <span class="post-toc-text">三. Dart的异步补充</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-1-任务执行顺序"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">3.1. 任务执行顺序</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-1-1-认识微任务队列"><span class="post-toc-number">3.1.1.</span> <span class="post-toc-text">3.1.1. 认识微任务队列</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-1-2-如何创建微任务"><span class="post-toc-number">3.1.2.</span> <span class="post-toc-text">3.1.2. 如何创建微任务</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-1-3-代码执行顺序"><span class="post-toc-number">3.1.3.</span> <span class="post-toc-text">3.1.3. 代码执行顺序</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-2-多核CPU的利用"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">3.2. 多核CPU的利用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-2-1-Isolate的理解"><span class="post-toc-number">3.2.1.</span> <span class="post-toc-text">3.2.1. Isolate的理解</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-2-2-Isolate通信机制"><span class="post-toc-number">3.2.2.</span> <span class="post-toc-text">3.2.2. Isolate通信机制</span></a></li></ol></li></ol></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                [Flutter] 05-Dart中异步
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar2.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>codeTao</strong>
        <span>6月 19, 2020</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/Flutter/">Flutter</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=[Flutter] 05-Dart中异步&url=http://yoursite.com/2020/06/19/Flutter-05-Dart中异步/index.html&pic=http://yoursite.com/img/favicon.jpg&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=[Flutter] 05-Dart中异步&url=http://yoursite.com/2020/06/19/Flutter-05-Dart中异步/index.html&via=codeTao" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2020/06/19/Flutter-05-Dart中异步/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://yoursite.com/2020/06/19/Flutter-05-Dart中异步/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=codeTao&title=[Flutter] 05-Dart中异步&summary=&pics=http://yoursite.com/img/favicon.jpg&url=http://yoursite.com/2020/06/19/Flutter-05-Dart中异步/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h2 id="一-Dart的异步模型"><a href="#一-Dart的异步模型" class="headerlink" title="一. Dart的异步模型"></a>一. Dart的异步模型</h2><blockquote>
<p>我们先来看一下Dart是如何进行异步操作的</p>
</blockquote>
<h3 id="1-1-Dart是单线程的"><a href="#1-1-Dart是单线程的" class="headerlink" title="1.1. Dart是单线程的"></a>1.1. Dart是单线程的</h3><h4 id="1-1-1-程序中的耗时操作"><a href="#1-1-1-程序中的耗时操作" class="headerlink" title="1.1.1. 程序中的耗时操作"></a>1.1.1. 程序中的耗时操作</h4><p><strong>开发中的耗时操作：</strong></p>
<ul>
<li>在开发中，我们经常会遇到一些耗时的操作需要完成，比如网络请求、文件读取等等；</li>
<li>如果我们的主线程一直在等待这些耗时的操作完成，那么就会进行阻塞，无法响应其它事件，比如用户的点击；</li>
</ul>
<p><strong>如何处理耗时的操作呢？</strong></p>
<ul>
<li>针对如何处理耗时的操作，不同的语言有不同的处理方式。</li>
<li><strong>处理方式一：</strong> 多线程，比如Java、C++，我们普遍的做法是开启一个新的线程（Thread），在新的线程中完成这些异步的操作，再通过线程间通信的方式，将拿到的数据传递给主线程。</li>
<li><strong>处理方式二：</strong> 单线程+事件循环，比如JavaScript、Dart都是基于单线程加事件循环来完成耗时操作的处理。不过单线程如何能进行耗时的操作呢？！</li>
</ul>
<h4 id="1-1-2-单线程的异步操作"><a href="#1-1-2-单线程的异步操作" class="headerlink" title="1.1.2. 单线程的异步操作"></a>1.1.2. 单线程的异步操作</h4><p>很多开发者可能都对单线程的异步操作充满了问号？？？</p>
<p>其实它们并不冲突：</p>
<ul>
<li>因为我们的一个应用程序大部分时间都是处于空闲的状态的，并不是无限制的在和用户进行交互。</li>
<li>比如等待用户点击、网络请求数据的返回、文件读写的IO操作，这些等待的行为并不会阻塞我们的线程；</li>
<li>这是因为类似于网络请求、文件读写的IO，我们都可以基于非阻塞调用；</li>
</ul>
<p><strong>阻塞式调用和非阻塞式调用</strong></p>
<p>如果想搞懂这个点，我们需要知道操作系统中的<code>阻塞式调用</code>和<code>非阻塞式调用</code>的概念。</p>
<ul>
<li>阻塞和非阻塞关注的是<strong>程序在等待调用结果（消息，返回值）时的状态。</strong></li>
<li><strong>阻塞式调用：</strong> 调用结果返回之前，当前线程会被挂起，调用线程只有在得到调用结果之后才会继续执行。</li>
<li><strong>非阻塞式调用：</strong> 调用执行之后，当前线程不会停止执行，只需要过一段时间来检查一下有没有结果返回即可。</li>
</ul>
<p>我们用一个生活中的例子来模拟：</p>
<ul>
<li>你中午饿了，需要点一份外卖，点<code>外卖的动作</code>就是我们的调用，拿到<code>最后点的外卖</code>就是我们要等待的结果。</li>
<li><strong>阻塞式调用：</strong> 点了外卖，不再做任何事情，就是在傻傻的等待，你的线程停止了任何其他的工作。</li>
<li><strong>非阻塞式调用：</strong> 点了外卖，继续做其他事情：继续工作、打把游戏，你的线程没有继续执行其他事情，只需要偶尔去看一下有没有人敲门，外卖有没有送到即可。</li>
</ul>
<p>而我们开发中的很多耗时操作，都可以基于这样的 <code>非阻塞式调用</code>：</p>
<ul>
<li>比如网络请求本身使用了Socket通信，而Socket本身提供了select模型，可以进行<code>非阻塞方式的工作</code>；</li>
<li>比如文件读写的IO操作，我们可以使用操作系统提供的<code>基于事件的回调机制</code>；</li>
</ul>
<p>这些操作都不会阻塞我们单线程的继续执行，我们的线程在等待的过程中可以继续去做别的事情：喝杯咖啡、打把游戏，等真正有了响应，再去进行对应的处理即可。</p>
<p>这时，我们可能有两个问题：</p>
<ul>
<li><strong>问题一：</strong> 如果在多核CPU中，单线程是不是就没有充分利用CPU呢？这个问题，我会放在后面来讲解。</li>
<li><strong>问题二：</strong> 单线程是如何来处理网络通信、IO操作它们返回的结果呢？答案就是事件循环（Event Loop）。</li>
</ul>
<h3 id="1-2-Dart事件循环"><a href="#1-2-Dart事件循环" class="headerlink" title="1.2. Dart事件循环"></a>1.2. Dart事件循环</h3><h4 id="1-2-1-什么是事件循环"><a href="#1-2-1-什么是事件循环" class="headerlink" title="1.2.1. 什么是事件循环"></a>1.2.1. 什么是事件循环</h4><p>单线程模型中主要就是在维护着一个事件循环（Event Loop）。</p>
<p>事件循环是什么呢？</p>
<ul>
<li>事实上事件循环并不复杂，它就是将需要处理的一系列事件（包括点击事件、IO事件、网络事件）放在一个事件队列（Event Queue）中。</li>
<li>不断的从事件队列（Event Queue）中取出事件，并执行其对应需要执行的代码块，直到事件队列清空位置。</li>
</ul>
<p>我们来写一个事件循环的伪代码：</p>
<pre><code>// 这里我使用数组模拟队列, 先进先出的原则
List eventQueue = []; 
var event;

// 事件循环从启动的一刻，永远在执行
while (true) {
  if (eventQueue.length &gt; 0) {
    // 取出一个事件
    event = eventQueue.removeAt(0);
    // 执行该事件
    event();
  }
}
</code></pre><p>当我们有一些事件时，比如点击事件、IO事件、网络事件时，它们就会被加入到<code>eventLoop</code>中，当发现事件队列不为空时发现，就会取出事件，并且执行。</p>
<h4 id="1-2-2-事件循环代码模拟"><a href="#1-2-2-事件循环代码模拟" class="headerlink" title="1.2.2. 事件循环代码模拟"></a>1.2.2. 事件循环代码模拟</h4><p>这里我们来看一段伪代码，理解点击事件和网络请求的事件是如何被执行的：</p>
<ul>
<li>这是一段Flutter代码，很多东西大家可能不是特别理解，但是耐心阅读你会读懂我们在做什么。</li>
<li>一个按钮RaisedButton，当发生点击时执行onPressed函数。</li>
<li>onPressed函数中，我们发送了一个网络请求，请求成功后会执行then中的回调函数。</li>
</ul>
<pre><code>RaisedButton(
  child: Text(&#39;Click me&#39;),
  onPressed: () {
    final myFuture = http.get(&#39;https://example.com&#39;);
    myFuture.then((response) {
      if (response.statusCode == 200) {
        print(&#39;Success!&#39;);
      }
    });
  },
)
</code></pre><p>这些代码是如何放在事件循环中执行呢？</p>
<ul>
<li>1、当用户发生点击的时候，onPressed回调函数被放入事件循环中执行，执行的过程中发送了一个网络请求。</li>
<li>2、网络请求发出去后，该事件循环不会被阻塞，而是发现要执行的onPressed函数已经结束，会将它丢弃掉。</li>
<li>3、网络请求成功后，会执行then中传入的回调函数，这也是一个事件，该事件被放入到事件循环中执行，执行完毕后，事件循环将其丢弃。</li>
</ul>
<p>尽管onPressed和then中的回调有一些差异，但是它们对于事件循环来说，都是告诉它：<strong>我有一段代码需要执行，快点帮我完成。</strong></p>
<h2 id="二-Dart的异步操作"><a href="#二-Dart的异步操作" class="headerlink" title="二. Dart的异步操作"></a>二. Dart的异步操作</h2><blockquote>
<p>Dart中的异步操作主要使用Future以及async、await。</p>
<p>如果你之前有过前端的ES6、ES7编程经验，那么完全可以将Future理解成Promise，async、await和ES7中基本一致。</p>
<p>但是如果没有前端开发经验，Future以及async、await如何理解呢？</p>
</blockquote>
<h3 id="2-1-认识Future"><a href="#2-1-认识Future" class="headerlink" title="2.1. 认识Future"></a>2.1. 认识Future</h3><h4 id="2-1-1-同步的网络请求"><a href="#2-1-1-同步的网络请求" class="headerlink" title="2.1.1. 同步的网络请求"></a>2.1.1. 同步的网络请求</h4><p>我们先来看一个例子吧：</p>
<ul>
<li>在这个例子中，我使用getNetworkData来模拟了一个网络请求；</li>
<li>该网络请求需要3秒钟的时间，之后返回数据；</li>
</ul>
<pre><code>import &quot;dart:io&quot;;

main(List&lt;String&gt; args) {
  print(&quot;main function start&quot;);
  print(getNetworkData());
  print(&quot;main function end&quot;);
}

String getNetworkData() {
  sleep(Duration(seconds: 3));
  return &quot;network data&quot;;
}
</code></pre><p>这段代码会运行怎么的结果呢？</p>
<ul>
<li>getNetworkData会阻塞main函数的执行</li>
</ul>
<pre><code>main function start
// 等待3秒
network data
main function end
</code></pre><p>显然，上面的代码不是我们想要的执行效果，因为网络请求阻塞了main函数，那么意味着其后所有的代码都无法正常的继续执行。</p>
<h4 id="2-1-2-异步的网络请求"><a href="#2-1-2-异步的网络请求" class="headerlink" title="2.1.2. 异步的网络请求"></a>2.1.2. 异步的网络请求</h4><p>我们来对我们上面的代码进行改进，代码如下：</p>
<ul>
<li>和刚才的代码唯一的区别在于我使用了Future对象来将耗时的操作放在了其中传入的函数中；</li>
<li>稍后，我们会讲解它具体的一些API，我们就暂时知道我创建了一个Future实例即可；</li>
</ul>
<pre><code>import &quot;dart:io&quot;;

main(List&lt;String&gt; args) {
  print(&quot;main function start&quot;);
  print(getNetworkData());
  print(&quot;main function end&quot;);
}

Future&lt;String&gt; getNetworkData() {
  return Future&lt;String&gt;(() {
    sleep(Duration(seconds: 3));
    return &quot;network data&quot;;
  });
}
</code></pre><p>我们来看一下代码的运行结果：</p>
<ul>
<li>1、这一次的代码顺序执行，没有出现任何的阻塞现象；</li>
<li>2、和之前直接打印结果不同，这次我们打印了一个Future实例；</li>
<li>结论：我们将一个耗时的操作隔离了起来，这个操作不会再影响我们的主线程执行了。</li>
<li>问题：我们如何去拿到最终的结果呢？</li>
</ul>
<pre><code>main function start
Instance of &#39;Future&lt;String&gt;&#39;
main function end
</code></pre><p><strong>获取Future得到的结果</strong></p>
<p>有了Future之后，如何去获取请求到的结果：通过.then的回调：</p>
<pre><code>main(List&lt;String&gt; args) {
  print(&quot;main function start&quot;);
  // 使用变量接收getNetworkData返回的future
  var future = getNetworkData();
  // 当future实例有返回结果时，会自动回调then中传入的函数
  // 该函数会被放入到事件循环中，被执行
  future.then((value) {
    print(value);
  });
  print(future);
  print(&quot;main function end&quot;);
}
</code></pre><p>上面代码的执行结果：</p>
<pre><code>main function start
Instance of &#39;Future&lt;String&gt;&#39;
main function end
// 3s后执行下面的代码
network data
</code></pre><p><strong>执行中出现异常</strong></p>
<p>如果调用过程中出现了异常，拿不到结果，如何获取到异常的信息呢？</p>
<pre><code>import &quot;dart:io&quot;;

main(List&lt;String&gt; args) {
  print(&quot;main function start&quot;);
  var future = getNetworkData();
  future.then((value) {
    print(value);
  }).catchError((error) { // 捕获出现异常时的情况
    print(error);
  });
  print(future);
  print(&quot;main function end&quot;);
}

Future&lt;String&gt; getNetworkData() {
  return Future&lt;String&gt;(() {
    sleep(Duration(seconds: 3));
    // 不再返回结果，而是出现异常
    // return &quot;network data&quot;;
    throw Exception(&quot;网络请求出现错误&quot;);
  });
}
</code></pre><p>上面代码的执行结果：</p>
<pre><code>main function start
Instance of &#39;Future&lt;String&gt;&#39;
main function end
// 3s后没有拿到结果，但是我们捕获到了异常
Exception: 网络请求出现错误
</code></pre><h4 id="2-1-3-Future使用补充"><a href="#2-1-3-Future使用补充" class="headerlink" title="2.1.3. Future使用补充"></a>2.1.3. Future使用补充</h4><p><strong>补充一：上面案例的小结</strong></p>
<p>我们通过一个案例来学习了一些Future的使用过程：</p>
<ul>
<li>1、创建一个Future（可能是我们创建的，也可能是调用内部API或者第三方API获取到的一个Future，总之你需要获取到一个Future实例，Future通常会对一些异步的操作进行封装）；</li>
<li>2、通过.then(成功回调函数)的方式来监听Future内部执行完成时获取到的结果；</li>
<li>3、通过.catchError(失败或异常回调函数)的方式来监听Future内部执行失败或者出现异常时的错误信息；</li>
</ul>
<p><strong>补充二：Future的两种状态</strong></p>
<p>事实上Future在执行的整个过程中，我们通常把它划分成了两种状态：</p>
<p>状态一：<strong>未完成状态（uncompleted）</strong></p>
<ul>
<li>执行Future内部的操作时（在上面的案例中就是具体的网络请求过程，我们使用了延迟来模拟），我们称这个过程为未完成状态</li>
</ul>
<p>状态二：<strong>完成状态（completed）</strong></p>
<ul>
<li>当Future内部的操作执行完成，通常会返回一个值，或者抛出一个异常。</li>
<li>这两种情况，我们都称Future为完成状态。</li>
</ul>
<p>Dart官网有对这两种状态解析，之所以贴出来是区别于Promise的三种状态</p>
<p><img src="https://upload-images.jianshu.io/upload_images/126164-25cd6adc1d4b791e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><strong>补充三：Future的链式调用</strong></p>
<p>上面代码我们可以进行如下的改进：</p>
<ul>
<li>我们可以在then中继续返回值，会在下一个链式的then调用回调函数中拿到返回的结果</li>
</ul>
<pre><code>import &quot;dart:io&quot;;

main(List&lt;String&gt; args) {
  print(&quot;main function start&quot;);

  getNetworkData().then((value1) {
    print(value1);
    return &quot;content data2&quot;;
  }).then((value2) {
    print(value2);
    return &quot;message data3&quot;;
  }).then((value3) {
    print(value3);
  });

  print(&quot;main function end&quot;);
}

Future&lt;String&gt; getNetworkData() {
  return Future&lt;String&gt;(() {
    sleep(Duration(seconds: 3));
    // 不再返回结果，而是出现异常
     return &quot;network data1&quot;;
  });
}
</code></pre><p>打印结果如下：</p>
<pre><code>main function start
main function end
// 3s后拿到结果
network data1
content data2
message data3
</code></pre><p><strong>补充四：Future其他API</strong></p>
<pre><code>Future.value(value)
</code></pre><ul>
<li>直接获取一个完成的Future，该Future会直接调用then的回调函数</li>
</ul>
<pre><code>main(List&lt;String&gt; args) {
  print(&quot;main function start&quot;);

  Future.value(&quot;哈哈哈&quot;).then((value) {
    print(value);
  });

  print(&quot;main function end&quot;);
}
</code></pre><p>打印结果如下：</p>
<pre><code>main function start
main function end
哈哈哈
</code></pre><p>疑惑：为什么立即执行，但是<code>哈哈哈</code>是在最后打印的呢？</p>
<ul>
<li>这是因为Future中的then会作为新的任务会加入到事件队列中（Event Queue），加入之后你肯定需要排队执行了</li>
</ul>
<pre><code>Future.error(object)
</code></pre><ul>
<li>直接获取一个完成的Future，但是是一个发生异常的Future，该Future会直接调用catchError的回调函数</li>
</ul>
<pre><code>main(List&lt;String&gt; args) {
  print(&quot;main function start&quot;);

  Future.error(Exception(&quot;错误信息&quot;)).catchError((error) {
    print(error);
  });

  print(&quot;main function end&quot;);
}
</code></pre><p>打印结果如下：</p>
<pre><code>main function start
main function end
Exception: 错误信息

Future.delayed(时间, 回调函数)
</code></pre><ul>
<li>在延迟一定时间时执行回调函数，执行完回调函数后会执行then的回调；</li>
<li>之前的案例，我们也可以使用它来模拟，但是直接学习这个API会让大家更加疑惑；</li>
</ul>
<pre><code>main(List&lt;String&gt; args) {
  print(&quot;main function start&quot;);

  Future.delayed(Duration(seconds: 3), () {
    return &quot;3秒后的信息&quot;;
  }).then((value) {
    print(value);
  });

  print(&quot;main function end&quot;);
}
</code></pre><h3 id="2-2-await、async"><a href="#2-2-await、async" class="headerlink" title="2.2. await、async"></a>2.2. await、async</h3><h4 id="2-2-1-理论概念理解"><a href="#2-2-1-理论概念理解" class="headerlink" title="2.2.1. 理论概念理解"></a>2.2.1. 理论概念理解</h4><p>如果你已经完全搞懂了Future，那么学习await、async应该没有什么难度。</p>
<p>await、async是什么呢？</p>
<ul>
<li>它们是Dart中的关键字</li>
<li>它们可以让我们用<code>同步的代码格式</code>，去实现<code>异步的调用过程</code>。</li>
<li>并且，通常一个async的函数会返回一个Future。</li>
</ul>
<p>我们已经知道，Future可以做到不阻塞我们的线程，让线程继续执行，并且在完成某个操作时改变自己的状态，并且回调then或者errorCatch回调。</p>
<p>如何生成一个Future呢？</p>
<ul>
<li>1、通过我们前面学习的Future构造函数，或者后面学习的Future其他API都可以。</li>
<li>2、还有一种就是通过async的函数。</li>
</ul>
<h4 id="2-2-2-案例代码演练"><a href="#2-2-2-案例代码演练" class="headerlink" title="2.2.2. 案例代码演练"></a>2.2.2. 案例代码演练</h4><p>我们来对之前的Future异步处理代码进行改造，改成await、async的形式。</p>
<p>我们知道，如果直接这样写代码，代码是不能正常执行的：</p>
<ul>
<li>因为Future.delayed返回的是一个Future对象，我们不能把它看成同步的返回数据：<code>&quot;network data&quot;</code>去使用</li>
<li>也就是我们不能把这个异步的代码当做同步一样去使用！</li>
</ul>
<pre><code>import &quot;dart:io&quot;;

main(List&lt;String&gt; args) {
  print(&quot;main function start&quot;);
  print(getNetworkData());
  print(&quot;main function end&quot;);
}

String getNetworkData() {
  var result = Future.delayed(Duration(seconds: 3), () {
    return &quot;network data&quot;;
  });

  return  &quot;请求到的数据：&quot; + result;
}
</code></pre><p>现在我使用await修改下面这句代码：</p>
<ul>
<li>你会发现，我在<code>Future.delayed</code>函数前加了一个await。</li>
<li>一旦有了这个关键字，那么这个操作就会等待<code>Future.delayed</code>的执行完毕，并且等待它的结果。</li>
</ul>
<pre><code>String getNetworkData() {
  var result = await Future.delayed(Duration(seconds: 3), () {
    return &quot;network data&quot;;
  });

  return  &quot;请求到的数据：&quot; + result;
}
</code></pre><p>修改后执行代码，会看到如下的错误：</p>
<ul>
<li>错误非常明显：await关键字必须存在于async函数中。</li>
<li>所以我们需要将<code>getNetworkData</code>函数定义成async函数。</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/126164-4facf8083248be2e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>继续修改代码如下：</p>
<ul>
<li>也非常简单，只需要在函数的()后面加上一个async关键字就可以了</li>
</ul>
<pre><code>String getNetworkData() async {
  var result = await Future.delayed(Duration(seconds: 3), () {
    return &quot;network data&quot;;
  });

  return  &quot;请求到的数据：&quot; + result;
}
</code></pre><p>运行代码，依然报错：</p>
<ul>
<li>错误非常明显：使用async标记的函数，必须返回一个Future对象。</li>
<li>所以我们需要继续修改代码，将返回值写成一个Future。</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/126164-5e242d435aba631a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>继续修改代码如下：</p>
<pre><code>Future&lt;String&gt; getNetworkData() async {
  var result = await Future.delayed(Duration(seconds: 3), () {
    return &quot;network data&quot;;
  });

  return &quot;请求到的数据：&quot; + result;
}
</code></pre><p>这段代码应该是我们理想当中执行的代码了</p>
<ul>
<li>我们现在可以像同步代码一样去使用Future异步返回的结果；</li>
<li>等待拿到结果之后和其他数据进行拼接，然后一起返回；</li>
<li>返回的时候并不需要包装一个Future，直接返回即可，但是返回值会默认被包装在一个Future中；</li>
</ul>
<h3 id="2-3-读取json案例"><a href="#2-3-读取json案例" class="headerlink" title="2.3. 读取json案例"></a>2.3. 读取json案例</h3><blockquote>
<p>我这里给出了一个在Flutter项目中，读取一个本地的json文件，并且转换成模型对象，返回出去的案例；</p>
<p>这个案例作为大家学习前面Future和await、async的一个参考，我并不打算展开来讲，因为需要用到Flutter的相关知识；</p>
<p>后面我会在后面的案例中再次讲解它在Flutter中我使用的过程中；</p>
</blockquote>
<p>读取json案例代码（了解一下即可）</p>
<pre><code>import &#39;package:flutter/services.dart&#39; show rootBundle;
import &#39;dart:convert&#39;;
import &#39;dart:async&#39;;

main(List&lt;String&gt; args) {
  getAnchors().then((anchors) {
    print(anchors);
  });
}

class Anchor {
  String nickname;
  String roomName;
  String imageUrl;

  Anchor({
    this.nickname,
    this.roomName,
    this.imageUrl
  });

  Anchor.withMap(Map&lt;String, dynamic&gt; parsedMap) {
    this.nickname = parsedMap[&quot;nickname&quot;];
    this.roomName = parsedMap[&quot;roomName&quot;];
    this.imageUrl = parsedMap[&quot;roomSrc&quot;];
  }
}

Future&lt;List&lt;Anchor&gt;&gt; getAnchors() async {
  // 1.读取json文件
  String jsonString = await rootBundle.loadString(&quot;assets/yz.json&quot;);

  // 2.转成List或Map类型
  final jsonResult = json.decode(jsonString);

  // 3.遍历List，并且转成Anchor对象放到另一个List中
  List&lt;Anchor&gt; anchors = new List();
  for (Map&lt;String, dynamic&gt; map in jsonResult) {
    anchors.add(Anchor.withMap(map));
  }
  return anchors;
}
</code></pre><h2 id="三-Dart的异步补充"><a href="#三-Dart的异步补充" class="headerlink" title="三. Dart的异步补充"></a>三. Dart的异步补充</h2><h3 id="3-1-任务执行顺序"><a href="#3-1-任务执行顺序" class="headerlink" title="3.1. 任务执行顺序"></a>3.1. 任务执行顺序</h3><h4 id="3-1-1-认识微任务队列"><a href="#3-1-1-认识微任务队列" class="headerlink" title="3.1.1. 认识微任务队列"></a>3.1.1. 认识微任务队列</h4><p>在前面学习学习中，我们知道Dart中有一个事件循环（Event Loop）来执行我们的代码，里面存在一个事件队列（Event Queue），事件循环不断从事件队列中取出事件执行。</p>
<p>但是如果我们严格来划分的话，在Dart中还存在另一个队列：微任务队列（Microtask Queue）。</p>
<ul>
<li>微任务队列的优先级要高于事件队列；</li>
<li>也就是说<code>事件循环</code>都是优先执行<code>微任务队列</code>中的任务，再执行 <code>事件队列</code> 中的任务；</li>
</ul>
<p>那么在Flutter开发中，哪些是放在事件队列，哪些是放在微任务队列呢？</p>
<ul>
<li>所有的外部事件任务都在事件队列中，如IO、计时器、点击、以及绘制事件等；</li>
<li>而微任务通常来源于Dart内部，并且微任务非常少。这是因为如果微任务非常多，就会造成事件队列排不上队，会阻塞任务队列的执行（比如用户点击没有反应的情况）；</li>
</ul>
<p>说道这里，你可能已经有点凌乱了，在Dart的单线程中，代码到底是怎样执行的呢？</p>
<ul>
<li>1、Dart的入口是main函数，所以<code>main函数中的代码</code>会优先执行；</li>
<li>2、main函数执行完后，会启动一个事件循环（Event Loop）就会启动，启动后开始执行队列中的任务；</li>
<li>3、首先，会按照先进先出的顺序，执行 <code>微任务队列（Microtask Queue）</code>中的所有任务；</li>
<li>4、其次，会按照先进先出的顺序，执行 <code>事件队列（Event Queue）</code>中的所有任务；</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/126164-c859ed6c62062590.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="代码执行顺序"></p>
<h4 id="3-1-2-如何创建微任务"><a href="#3-1-2-如何创建微任务" class="headerlink" title="3.1.2. 如何创建微任务"></a>3.1.2. 如何创建微任务</h4><p>在开发中，我们可以通过dart中async下的scheduleMicrotask来创建一个微任务：</p>
<pre><code>import &quot;dart:async&quot;;

main(List&lt;String&gt; args) {
  scheduleMicrotask(() {
    print(&quot;Hello Microtask&quot;);
  });
}
</code></pre><p>在开发中，如果我们有一个任务不希望它放在Event Queue中依次排队，那么就可以创建一个微任务了。</p>
<p><strong>Future的代码是加入到事件队列还是微任务队列呢？</strong></p>
<p>Future中通常有两个函数执行体：</p>
<ul>
<li>Future构造函数传入的函数体</li>
<li>then的函数体（catchError等同看待）</li>
</ul>
<p>那么它们是加入到什么队列中的呢？</p>
<ul>
<li>Future构造函数传入的函数体放在事件队列中</li>
<li>then的函数体要分成三种情况：</li>
<li>情况一：Future没有执行完成（有任务需要执行），那么then会直接被添加到Future的函数执行体后；</li>
<li>情况二：如果Future执行完后就then，该then的函数体被放到如微任务队列，当前Future执行完后执行微任务队列；</li>
<li>情况三：如果Future世链式调用，意味着then未执行完，下一个then不会执行；</li>
</ul>
<pre><code>// future_1加入到eventqueue中，紧随其后then_1被加入到eventqueue中
Future(() =&gt; print(&quot;future_1&quot;)).then((_) =&gt; print(&quot;then_1&quot;));

// Future没有函数执行体，then_2被加入到microtaskqueue中
Future(() =&gt; null).then((_) =&gt; print(&quot;then_2&quot;));

// future_3、then_3_a、then_3_b依次加入到eventqueue中
Future(() =&gt; print(&quot;future_3&quot;)).then((_) =&gt; print(&quot;then_3_a&quot;)).then((_) =&gt; print(&quot;then_3_b&quot;));
</code></pre><h4 id="3-1-3-代码执行顺序"><a href="#3-1-3-代码执行顺序" class="headerlink" title="3.1.3. 代码执行顺序"></a>3.1.3. 代码执行顺序</h4><p>我们根据前面的规则来学习一个<code>极的代码执行顺序</code>案例：</p>
<pre><code>import &quot;dart:async&quot;;

main(List&lt;String&gt; args) {
  print(&quot;main start&quot;);

  Future(() =&gt; print(&quot;task1&quot;));

  final future = Future(() =&gt; null);

  Future(() =&gt; print(&quot;task2&quot;)).then((_) {
    print(&quot;task3&quot;);
    scheduleMicrotask(() =&gt; print(&#39;task4&#39;));
  }).then((_) =&gt; print(&quot;task5&quot;));

  future.then((_) =&gt; print(&quot;task6&quot;));
  scheduleMicrotask(() =&gt; print(&#39;task7&#39;));

  Future(() =&gt; print(&#39;task8&#39;))
    .then((_) =&gt; Future(() =&gt; print(&#39;task9&#39;)))
    .then((_) =&gt; print(&#39;task10&#39;));

  print(&quot;main end&quot;);
}
</code></pre><p>代码执行的结果是：</p>
<pre><code>main start
main end
task7
task1
task6
task2
task3
task5
task4
task8
task9
task10
</code></pre><p>代码分析：</p>
<ul>
<li>1、main函数先执行，所以<code>main start</code>和<code>main end</code>先执行，没有任何问题；</li>
<li>2、main函数执行<code>过程中</code>，会将一些任务分别加入到<code>EventQueue</code>和<code>MicrotaskQueue</code>中；</li>
<li>3、task7通过<code>scheduleMicrotask</code>函数调用，所以它被最早加入到<code>MicrotaskQueue</code>，会被先执行；</li>
<li>4、然后开始执行<code>EventQueue</code>，task1被添加到<code>EventQueue</code>中被执行；</li>
<li>5、通过<code>final future = Future(() =&gt; null);</code>创建的future的then被添加到微任务中，微任务直接被优先执行，所以会执行task6；</li>
<li>6、一次在<code>EventQueue</code>中添加task2、task3、task5被执行；</li>
<li>7、task3的打印执行完后，调用<code>scheduleMicrotask</code>，那么在执行完这次的<code>EventQueue</code>后会执行，所以在task5后执行task4（注意：<code>scheduleMicrotask</code>的调用是作为task3的一部分代码，所以task4是要在task5之后执行的）</li>
<li>8、task8、task9、task10一次添加到<code>EventQueue</code>被执行；</li>
</ul>
<p>事实上，上面的代码执行顺序有可能出现在面试中，我们开发中通常不会出现这种复杂的嵌套，并且需要完全搞清楚它的执行顺序；</p>
<p>但是，了解上面的代码执行顺序，会让你对<code>EventQueue</code>和<code>microtaskQueue</code>有更加深刻的理解。</p>
<h3 id="3-2-多核CPU的利用"><a href="#3-2-多核CPU的利用" class="headerlink" title="3.2. 多核CPU的利用"></a>3.2. 多核CPU的利用</h3><h4 id="3-2-1-Isolate的理解"><a href="#3-2-1-Isolate的理解" class="headerlink" title="3.2.1. Isolate的理解"></a>3.2.1. Isolate的理解</h4><p>在Dart中，有一个Isolate的概念，它是什么呢？</p>
<ul>
<li>我们已经知道Dart是单线程的，这个线程有自己可以访问的内存空间以及需要运行的事件循环；</li>
<li>我们可以将这个空间系统称之为是一个Isolate；</li>
<li>比如Flutter中就有一个Root Isolate，负责运行Flutter的代码，比如UI渲染、用户交互等等；</li>
</ul>
<p>在 Isolate 中，资源隔离做得非常好，每个 Isolate 都有自己的 Event Loop 与 Queue，</p>
<ul>
<li>Isolate 之间不共享任何资源，只能依靠消息机制通信，因此也就没有资源抢占问题。</li>
</ul>
<p>但是，如果只有一个Isolate，那么意味着我们只能永远利用一个线程，这对于多核CPU来说，是一种资源的浪费。</p>
<p>如果在开发中，我们有非常多耗时的计算，完全可以自己创建Isolate，在独立的Isolate中完成想要的计算操作。</p>
<p><strong>如何创建Isolate呢？</strong></p>
<p>创建Isolate是比较简单的，我们通过<code>Isolate.spawn</code>就可以创建了：</p>
<pre><code>import &quot;dart:isolate&quot;;

main(List&lt;String&gt; args) {
  Isolate.spawn(foo, &quot;Hello Isolate&quot;);
}

void foo(info) {
  print(&quot;新的isolate：$info&quot;);
}
</code></pre><h4 id="3-2-2-Isolate通信机制"><a href="#3-2-2-Isolate通信机制" class="headerlink" title="3.2.2. Isolate通信机制"></a>3.2.2. Isolate通信机制</h4><p>但是在真实开发中，我们不会只是简单的开启一个新的Isolate，而不关心它的运行结果：</p>
<ul>
<li>我们需要新的Isolate进行计算，并且将计算结果告知Main Isolate（也就是默认开启的Isolate）；</li>
<li>Isolate 通过发送管道（SendPort）实现消息通信机制；</li>
<li>我们可以在启动并发Isolate时将Main Isolate的发送管道作为参数传递给它；</li>
<li>并发在执行完毕时，可以利用这个管道给Main Isolate发送消息；</li>
</ul>
<pre><code>import &quot;dart:isolate&quot;;

main(List&lt;String&gt; args) async {
  // 1.创建管道
  ReceivePort receivePort= ReceivePort();

  // 2.创建新的Isolate
  Isolate isolate = await Isolate.spawn&lt;SendPort&gt;(foo, receivePort.sendPort);

  // 3.监听管道消息
  receivePort.listen((data) {
    print(&#39;Data：$data&#39;);
    // 不再使用时，我们会关闭管道
    receivePort.close();
    // 需要将isolate杀死
    isolate?.kill(priority: Isolate.immediate);
  });
}

void foo(SendPort sendPort) {
  sendPort.send(&quot;Hello World&quot;);
}
</code></pre><p>但是我们上面的通信变成了单向通信，如果需要双向通信呢？</p>
<ul>
<li>事实上双向通信的代码会比较麻烦；</li>
<li>Flutter提供了支持并发计算的<code>compute</code>函数，它内部封装了Isolate的创建和双向通信；</li>
<li>利用它我们可以充分利用多核心CPU，并且使用起来也非常简单；</li>
</ul>
<p>注意：下面的代码不是dart的API，而是Flutter的API，所以只有在Flutter项目中才能运行</p>
<pre><code>main(List&lt;String&gt; args) async {
  int result = await compute(powerNum, 5);
  print(result);
}

int powerNum(int num) {
  return num * num;
}
</code></pre>
        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 Gitalk -->
<div id="gitalk-comment">
    <!-- Gitalk 评论框 -->
<div id="gitalk-container"></div>

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">

<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<script src="/js/md5.min.js"></script>

<script>
    var gitalk = new Gitalk({
            clientID: '831359b6ab3a9f127d1b',
            clientSecret: '0022bff5442e5f0135eeddf065b6d72eff9f5ae3',
            repo: 'honkerSK.github.io',
            owner: 'honkerSK',
            admin: ['honkerSK'],
            // facebook-like distraction free mode
            id: md5(location.pathname),
            distractionFreeMode: false
        })
   gitalk.render('gitalk-container')
</script>

</div>
<style>
    #gitalk-comment {
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2020/06/20/Flutter-06-Flutter的网络请求/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2020/06/18/Flutter-04-Dart语法二/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.jpg);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar2.png" alt="codeTao's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        geeksk54@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto: geeksk54@gmail.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2020/07/">七月 2020<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/06/">六月 2020<span class="sidebar_archives-count">32</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/05/">五月 2020<span class="sidebar_archives-count">16</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/11/">十一月 2018<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/09/">九月 2018<span class="sidebar_archives-count">39</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/08/">八月 2018<span class="sidebar_archives-count">3</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Tool/">Tool<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/categories/iOS/">iOS<span class="sidebar_archives-count">33</span></a></li><li><a class="sidebar_archives-link" href="/categories/iOS文档/">iOS文档<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/categories/iOS笔记/">iOS笔记<span class="sidebar_archives-count">40</span></a></li><li><a class="sidebar_archives-link" href="/categories/前端/">前端<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/categories/随笔/">随笔<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags" title="标签云">
                
                    <i class="material-icons sidebar-material-icons">tab</i>
                
                标签云
            </a>
        </li>
        
    
        <li>
            <a href="/timeline" title="时间轴">
                
                    <i class="material-icons sidebar-material-icons">send</i>
                
                时间轴
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">100</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/twitter" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/facebook" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-facebook">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    

    <!-- V2EX -->
    

    <!-- Segmentfault -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;<span year></span>&nbsp;codeTao
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?Bn9UzEm8RrBSxqyZB0zPjA==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>







    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



   <!-- GitTalk -->





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    var copyrightNow = new Date().getFullYear();
    var textContent = document.querySelector('span[year]')

    copyrightSince = 0000;
    if (copyrightSince === copyrightNow||copyrightSince === 0000) {
        textContent.textContent = copyrightNow
    } else {
        textContent.textContent = copyrightSince + ' - ' + copyrightNow
    }

    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.6 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
